# application.yaml

server:
  port: 5000
  servlet:
    context-path: /
  compression:
    enabled: true
    connection-timeout: 300000

spring:
  application:
    name: e-commerce-backend

  main:
    allow-bean-definition-overriding: true

  # JPA Configuration
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        jdbc:
          lob:
            non_contextual_creation: true
          batch_size: 50
        order_inserts: true
        order_updates: true
        batch_versioned_data: true
        connection:
          provider_disables_autocommit: true
        cache:
          use_second_level_cache: false

  # Primary Database (PostgreSQL)
  datasource:
    url: jdbc:postgresql://localhost:5432/e-commerce
    username: postgres
    password: 88889999
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 1800000
      max-lifetime: 7200000
      leak-detection-threshold: 1800000
      pool-name: PostgreSQL-Pool
      auto-commit: false

  # Task Execution for Async Telegram notifications
  task:
    execution:
      pool:
        core-size: 2
        max-size: 5
        queue-capacity: 100
        thread-name-prefix: async-telegram-

# JWT Configuration
jwt:
  secret:
    key: f7e8d9c6b5a4938271605f4de3d2c1b0a9f8e7d6c5b4a392817f6e5d4c3b2a1908f7e6d5c4b3a29180716f5e4d3c2b1a001
  expiration-min: 525600
  issuer: ics-api

# Inventory Control System Configuration
app:
  default-users:
    create: true
  super:
    username: makara
    password: 88889999
    email: makara@gmail.com

  data-load:
    batch-size: 1000
    max-retries: 1
    timeout-hours: 5
    connection-timeout-minutes: 5
    query-timeout-hours: 4
    network-timeout-hours: 5
    progress-log-interval-minutes: 10
    heartbeat-interval-minutes: 5

# Logging Configuration
logging:
  level:
    root: INFO
    com.internal: INFO
    org.springframework.security: WARN
    org.springframework.web: WARN
    org.springframework.data.jpa: WARN
    org.hibernate: WARN
    org.hibernate.SQL: WARN
    org.hibernate.type.descriptor.sql.BasicBinder: WARN
    com.zaxxer.hikari: INFO
    org.postgresql: WARN
    org.springframework.mail: DEBUG
    org.springframework.mail.javamail: DEBUG
  pattern:
    console: "%d{HH:mm:ss.SSS} [%thread] %-5level %logger{20} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/ics-api.log
    max-size: 100MB
    max-history: 10

# OpenAPI Documentation
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    disable-swagger-default-url: true

# Management Endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,loggers,threaddump
  endpoint:
    health:
      show-details: always
  health:
    db:
      enabled: true
  metrics:
    export:
      simple:
      enabled: true